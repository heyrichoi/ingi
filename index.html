<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì¸ê¸° ë„ë„¤ ë£°ë ›</title>
<!-- Google Fonts: Jua -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
<style>
  :root {
    /* Neon Theme Palette */
    --bg-color: #120422; /* Deep violet black */
    --panel-color: #1e0a35; /* Dark violet */
    --accent-color: #d946ef; /* Neon Pink */
    --accent-hover: #c026d3;
    --secondary-accent: #22d3ee; /* Neon Cyan */
    --danger-color: #ff0055; /* Neon Red */
    --success-color: #00ff9d; /* Neon Green */
    --text-color: #ffffff;
    --text-muted: #a78bfa;
    --border-color: #4c1d95;
    
    --neon-glow: 0 0 10px rgba(217, 70, 239, 0.6), 0 0 20px rgba(217, 70, 239, 0.4);
    --neon-text-glow: 0 0 5px rgba(255, 255, 255, 0.8), 0 0 10px rgba(217, 70, 239, 0.8);
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    padding: 0;
    /* Font change to Jua */
    font-family: 'Jua', -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    background-color: #0f0219;
    /* Background: Radial Gradient Only */
    background-image: radial-gradient(circle at center, #2e1065 0%, #0f0219 100%);
    background-size: cover;
    background-attachment: fixed;
    color: var(--text-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    overflow: hidden;
  }

  .app-container {
    width: 100%;
    max-width: 1400px;
    height: 100vh;
    display: grid;
    grid-template-columns: 450px 1fr;
    gap: 0;
    background: rgba(30, 10, 53, 0.7);
    box-shadow: 0 0 50px rgba(139, 92, 246, 0.2);
    border: 1px solid rgba(139, 92, 246, 0.3);
    backdrop-filter: blur(10px);
  }

  /* --- LEFT COLUMN: ROULETTE --- */
  .roulette-section {
    background: rgba(20, 5, 35, 0.3); /* íˆ¬ëª…ë„ ë” ë‚®ì¶¤ (0.5 -> 0.3) */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-evenly; 
    padding: 20px;
    border-right: 1px solid var(--border-color);
    position: relative;
    height: 100vh;
    overflow: hidden;
    z-index: 10;
  }

  .wheel-container {
    position: relative;
    width: 380px;
    height: 380px;
    max-width: 40vh;
    max-height: 40vh;
    flex-shrink: 0;
    filter: drop-shadow(0 0 30px rgba(167, 139, 250, 0.4));
  }
  
  .wheel-ring {
    position: absolute;
    inset: -15px;
    border-radius: 50%;
    background: conic-gradient(from 0deg, #4c1d95, #d946ef, #4c1d95);
    box-shadow: 0 0 40px rgba(217, 70, 239, 0.5);
    z-index: 1;
    opacity: 0.8;
  }

  .wheel-rotator {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    position: relative;
    z-index: 2;
    /* Ensure transform-origin is center for rotation */
    transform-origin: center;
  }

  /* Fast spinning animation class */
  .wheel-rotator.spinning {
    animation: spin-infinite 0.08s linear infinite; /* ì†ë„ ëŒ€í­ ì¦ê°€ (0.5s -> 0.08s) */
  }

  @keyframes spin-infinite {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    position: absolute;
    top: 0;
    left: 0;
    overflow: hidden;
    border: 6px solid #2e1065;
    box-shadow: inset 0 0 30px rgba(0,0,0,0.9);
  }
  
  .wheel-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 60px;
    height: 60px;
    background: radial-gradient(circle, #fff 0%, #d946ef 100%);
    border-radius: 50%;
    z-index: 10;
    box-shadow: 0 0 20px rgba(217, 70, 239, 0.8);
    border: 3px solid #fff;
  }

  .pointer {
    position: absolute;
    top: -30px; /* ìœ„ì¹˜ ì¡°ì • */
    left: 50%;
    transform: translateX(-50%);
    width: 40px; /* ëª¨ì–‘ ë³€ê²½ì„ ìœ„í•´ ë„ˆë¹„ ì¡°ì • */
    height: 50px; /* ëª¨ì–‘ ë³€ê²½ì„ ìœ„í•´ ë†’ì´ ì¡°ì • */
    z-index: 20;
    /* ë„¤ì˜¨ íš¨ê³¼: ë°ì€ ì½”ì–´ + ê°•í•œ ê¸€ë¡œìš° */
    filter: drop-shadow(0 0 5px #d946ef) drop-shadow(0 0 15px #d946ef);
  }

  /* Labels */
  .wheel-labels {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 5;
    border-radius: 50%;
    overflow: hidden;
  }
  .slice-label {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 50%; 
    height: 0px;
    transform-origin: 0% 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding-left: 40px;
    padding-right: 15px;
  }
  .slice-label span {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: #fff;
    font-weight: 800;
    text-shadow: 0 0 4px rgba(0,0,0,0.9);
    font-size: 16px;
    max-width: 100%;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }

  /* Result Display */
  .result-display {
    text-align: center;
    margin: 10px 0;
    height: 80px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background: rgba(46, 16, 101, 0.4); /* íˆ¬ëª…ë„ ì¡°ì ˆ */
    padding: 10px 30px;
    border-radius: 16px;
    border: 1px solid rgba(217, 70, 239, 0.3);
    box-shadow: 0 0 20px rgba(217, 70, 239, 0.1) inset;
  }
  .result-label {
    font-size: 13px;
    color: var(--secondary-accent);
    margin-bottom: 4px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .result-value {
    font-size: 32px;
    font-weight: 900;
    color: #ffff00;
    text-shadow: 0 0 10px rgba(255, 255, 0, 0.6), 0 0 20px rgba(255, 255, 0, 0.4);
    letter-spacing: -0.5px;
  }
  /* Smaller detail text in result */
  .result-detail {
    font-size: 16px;
    color: var(--text-muted);
    font-weight: 600;
    margin-top: 4px;
    text-shadow: none;
  }

  /* --- Calculator Section --- */
  .calc-container {
    width: 100%;
    max-width: 380px;
    background: rgba(30, 10, 50, 0.4); /* íˆ¬ëª…ë„ ë” ë‚®ì¶¤ (0.6 -> 0.4) */
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 20px;
    flex-shrink: 0;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }
  .calc-header {
    color: var(--secondary-accent);
    font-weight: 700;
    font-size: 15px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    text-shadow: 0 0 5px rgba(34, 211, 238, 0.5);
  }
  .calc-header svg {
    width: 18px;
    height: 18px;
    filter: drop-shadow(0 0 2px var(--secondary-accent));
  }
  .calc-input-group {
    display: flex;
    align-items: center;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0 12px;
    margin-bottom: 8px;
    transition: all 0.2s;
  }
  .calc-input-group:focus-within {
    border-color: var(--secondary-accent);
    box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
  }
  .calc-input-group input {
    flex: 1;
    background: transparent;
    border: none;
    color: white;
    padding: 12px 5px;
    font-size: 16px;
    text-align: right;
    outline: none;
    font-weight: 600;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }
  .calc-input-group span {
    color: var(--text-muted);
    font-size: 13px;
    margin-left: 6px;
  }
  .calc-arrow {
    text-align: center;
    color: var(--text-muted);
    font-size: 11px;
    margin: 6px 0;
    font-weight: 500;
  }
  .calc-result-box {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .calc-stack {
    font-size: 28px;
    font-weight: 900;
    color: var(--success-color);
    text-shadow: 0 0 15px rgba(0, 255, 157, 0.4);
  }
  .calc-stack-label {
    font-size: 13px;
    color: var(--text-muted);
    margin-left: 2px;
  }
  .calc-sub-text {
    display: block;
    margin-top: 4px;
    font-size: 12px;
    color: var(--text-muted);
  }
  .calc-highlight {
    color: #e2e8f0;
    font-weight: 700;
  }


  /* --- RIGHT COLUMN: CONTROLS & TABLE --- */
  .controls-section {
    display: flex;
    flex-direction: column;
    padding: 30px 40px;
    background: transparent;
    height: 100vh;
    overflow: hidden;
    position: relative;
  }

  /* Mascot Image */
  .mascot-img {
    position: absolute;
    bottom: 0;
    right: 0;
    height: 60vh;
    width: auto;
    object-fit: contain;
    z-index: 0;
    pointer-events: none;
    opacity: 1; /* íˆ¬ëª…ë„ ì œê±° (0.8 -> 1) ì˜ ë³´ì´ë„ë¡ */
    transition: opacity 0.3s ease, transform 0.3s ease;
    filter: drop-shadow(0 0 20px rgba(0,0,0,0.5));
  }

  /* Header Area */
  .controls-header {
    display: flex;
    flex-direction: column; /* Stack button and timer for full width button */
    gap: 15px;
    margin-bottom: 24px;
    position: relative;
    z-index: 2;
    background: rgba(30, 10, 53, 0.5); /* íˆ¬ëª…ë„ ë” ë‚®ì¶¤ (0.7 -> 0.5) */
    backdrop-filter: blur(5px); /* ë¸”ëŸ¬ íš¨ê³¼ ì•½ê°„ ê°ì†Œ */
    padding: 25px 20px;
    border-radius: 20px;
    border: 1px solid var(--border-color);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    align-items: center;
  }

  /* Header Logo (Inline) */
  .header-logo-inline {
    height: 85px; /* ë¡œê³  í¬ê¸° í™•ëŒ€ (60px -> 85px) */
    width: auto;
    object-fit: contain;
    filter: drop-shadow(0 0 5px rgba(217, 70, 239, 0.5)); 
    margin-right: 30px; /* ê°„ê²© í™•ëŒ€ */
  }

  /* ë°˜ì‘í˜•: í™”ë©´ì´ ì‘ì•„ì§€ë©´ ë¡œê³  ìˆ¨ê¸°ê¸° (ìš°ì„ ìˆœìœ„ ë‚®ìŒ) */
  @media (max-width: 1100px) {
    .header-logo-inline {
      display: none;
    }
  }

  /* Spin Button */
  .spin-btn {
    background: linear-gradient(90deg, #d946ef, #8b5cf6);
    color: white;
    border: none;
    padding: 0 20px;
    height: 60px;
    font-size: 22px;
    font-weight: 900;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(217, 70, 239, 0.4);
    transition: all 0.2s;
    width: 100%; /* Full width */
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 2px 2px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }
  .spin-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(to bottom right, rgba(255,255,255,0.3), transparent, transparent);
      transform: rotate(45deg);
      transition: all 0.5s;
  }
  .spin-btn:hover::after {
      left: 100%;
  }
  .spin-btn.stop-mode {
    background: linear-gradient(90deg, #ff0055, #db2777);
    box-shadow: 0 0 20px rgba(255, 0, 85, 0.5);
  }
  .spin-btn:hover { transform: translateY(-2px); filter: brightness(1.2); }
  .spin-btn:active { transform: translateY(0); }
  .spin-btn:disabled { background: #475569; color: #94a3b8; box-shadow: none; cursor: not-allowed; transform: none; }

  /* Timer Controls */
  .timer-container {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    justify-content: center; /* íƒ€ì´ë¨¸ ì»¨íŠ¸ë¡¤ ì¤‘ì•™ ì •ë ¬ */
    margin-bottom: 5px;
  }

  .quick-timer-group {
    display: flex;
    gap: 8px;
  }
  .btn-quick {
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--border-color);
    color: var(--text-muted);
    font-size: 12px;
    font-weight: 600;
    padding: 8px 14px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }
  .btn-quick:hover {
    background: rgba(255,255,255,0.1);
    color: white;
    box-shadow: 0 0 10px rgba(255,255,255,0.1);
  }
  .btn-quick:active {
    background: var(--accent-color);
    border-color: var(--accent-color);
    color: white;
  }

  .timer-box {
    text-align: right;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
  }
  .timer-label {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 4px;
    font-weight: 600;
  }
  .timer-display {
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
    font-size: 42px;
    font-weight: 800;
    color: var(--secondary-accent);
    background: rgba(0,0,0,0.3);
    padding: 0 20px;
    height: 60px;
    line-height: 58px;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    cursor: pointer;
    box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
    transition: all 0.2s;
    text-shadow: 0 0 10px rgba(34, 211, 238, 0.4);
  }
  .timer-display:hover { border-color: var(--secondary-accent); }

  /* Urgent Timer Animation */
  .timer-display.urgent {
    color: var(--danger-color);
    text-shadow: 0 0 15px rgba(255, 0, 85, 0.6);
    border-color: var(--danger-color);
    animation: urgent-pulse 0.5s infinite alternate;
  }

  @keyframes urgent-pulse {
    0% { transform: scale(1); opacity: 1; text-shadow: 0 0 10px red; }
    100% { transform: scale(1.05); opacity: 0.8; text-shadow: 0 0 20px red, 0 0 40px red; }
  }

  .timer-edit-input {
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
    font-size: 36px;
    font-weight: 800;
    color: var(--secondary-accent);
    background: #181926;
    border: 1px solid var(--accent-color);
    width: 160px;
    height: 60px;
    padding: 0 10px;
    border-radius: 10px;
    text-align: center;
    display: none;
    outline: none;
  }

  /* Data Table */
  .data-table-container {
    flex: 1;
    background: rgba(20, 5, 35, 0.4); /* íˆ¬ëª…ë„ ë” ë‚®ì¶¤ (0.6 -> 0.4) */
    border-radius: 16px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    border: 1px solid var(--border-color);
    position: relative;
    z-index: 1;
    backdrop-filter: blur(5px);
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  }

  .table-header {
    display: grid;
    grid-template-columns: 70px 2fr 130px 100px;
    background: linear-gradient(90deg, rgba(76, 29, 149, 0.6), rgba(50, 10, 100, 0.6)); /* í—¤ë” íˆ¬ëª…ë„ ì¡°ì ˆ */
    color: #fff;
    font-weight: 700;
    padding: 10px 16px; /* íŒ¨ë”© ì¶•ì†Œ (16px -> 10px) */
    font-size: 14px; /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì•½ê°„ ì¶•ì†Œ (15px -> 14px) */
    align-items: center;
    text-align: center;
    border-bottom: 1px solid var(--border-color);
    text-shadow: 0 0 5px rgba(255,255,255,0.3);
  }
  
  .table-body {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 60px; /* í•˜ë‹¨ ì—¬ë°± ì¶•ì†Œ */
  }
  /* Custom Scrollbar */
  .table-body::-webkit-scrollbar { width: 6px; }
  .table-body::-webkit-scrollbar-track { background: transparent; }
  .table-body::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
  .table-body::-webkit-scrollbar-thumb:hover { background: var(--accent-color); }

  .table-row {
    display: grid;
    grid-template-columns: 70px 2fr 130px 100px;
    padding: 6px 16px; /* íŒ¨ë”© ì¶•ì†Œ (12px -> 6px) */
    border-bottom: 1px solid rgba(255,255,255,0.03);
    align-items: center;
    transition: background 0.2s;
  }
  .table-row:hover { background: rgba(217, 70, 239, 0.1); }

  .cell-action { 
    display: flex; 
    justify-content: center; 
    align-items: center; 
  }
  .btn-delete {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: var(--danger-color);
    width: 24px; /* í¬ê¸° ì¶•ì†Œ (28px -> 24px) */
    height: 24px;
    border-radius: 6px; /* ë‘¥ê¸€ê¸° ì•½ê°„ ì¡°ì • */
    cursor: pointer;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    transition: all 0.2s;
  }
  .btn-delete:hover { 
    background: var(--danger-color); 
    color: white; 
    box-shadow: 0 0 10px rgba(255, 0, 85, 0.4);
  }
  .btn-delete:disabled {
    filter: grayscale(1);
    cursor: not-allowed;
    opacity: 0.5;
  }

  /* Input centering */
  .cell-name {
    display: flex;
    justify-content: center;
    padding: 0 5px; /* ì¢Œìš° íŒ¨ë”© ì¶•ì†Œ */
  }
  .input-ghost {
    background: transparent;
    border: 1px solid transparent;
    color: var(--text-color);
    font-size: 14px; /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì¶•ì†Œ (15px -> 14px) */
    padding: 6px; /* íŒ¨ë”© ì¶•ì†Œ (8px -> 6px) */
    width: 100%;
    border-radius: 6px;
    text-align: center;
    transition: all 0.2s;
    font-weight: 500;
    font-family: 'Jua', sans-serif;
  }
  .input-ghost:focus {
    border-color: var(--accent-color);
    background: rgba(0,0,0,0.3);
    outline: none;
    box-shadow: 0 0 5px rgba(217, 70, 239, 0.3);
  }
  .input-ghost:disabled {
    color: var(--text-muted);
    cursor: not-allowed;
  }

  /* Weight Control Cell */
  .cell-weight {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    background: rgba(0,0,0,0.3);
    padding: 2px; /* íŒ¨ë”© ì¶•ì†Œ (4px -> 2px) */
    border-radius: 6px;
    width: fit-content;
    margin: 0 auto;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .weight-btn {
    background: transparent;
    color: var(--text-muted);
    border: none;
    width: 20px; /* ë²„íŠ¼ í¬ê¸° ì¶•ì†Œ (24px -> 20px) */
    height: 20px;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    transition: all 0.2s;
  }
  .weight-btn:hover {
    background: rgba(255,255,255,0.1);
    color: white;
  }
  .weight-btn:disabled {
    cursor: not-allowed;
    opacity: 0.3;
  }

  .input-number {
    text-align: center;
    font-family: 'Jua', sans-serif;
    width: 36px; /* ë„ˆë¹„ ì¶•ì†Œ */
    padding: 0;
    background: transparent;
    border: none;
    font-weight: 700;
    color: var(--secondary-accent);
    font-size: 14px;
  }
  .input-number:focus { background: transparent; border: none; }
  .input-number:disabled { color: var(--text-muted); }
  .input-number::-webkit-outer-spin-button,
  .input-number::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .prob-text {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px; /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì¶•ì†Œ */
    font-family: 'Jua', sans-serif;
  }

  /* Add Button Row */
  .add-row {
    padding: 10px; /* íŒ¨ë”© ì¶•ì†Œ (15px -> 10px) */
    border-top: 1px solid var(--border-color);
    background: rgba(20, 5, 35, 0.7); /* í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ íˆ¬ëª…ë„ ì¡°ì ˆ */
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
  }
  .btn-add {
    width: 100%;
    background: linear-gradient(90deg, #10b981, #059669);
    color: white;
    border: none;
    padding: 10px; /* íŒ¨ë”© ì¶•ì†Œ (14px -> 10px) */
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s;
    font-size: 15px; /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì•½ê°„ ì¶•ì†Œ */
    box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);
    font-family: 'Jua', sans-serif;
  }
  .btn-add:hover { filter: brightness(1.1); transform: translateY(-1px); }
  .btn-add:active { transform: translateY(0); }
  .btn-add:disabled {
    background: #4a5568;
    color: #a0aec0;
    box-shadow: none;
    cursor: not-allowed;
    transform: none;
  }

  /* Export Area */
  .export-area {
    margin-top: 20px;
    padding: 12px 16px;
    background: rgba(0, 0, 0, 0.2); /* íˆ¬ëª…ë„ ë” ë‚®ì¶¤ */
    border-radius: 12px;
    border: 1px solid var(--border-color);
    display: flex;
    gap: 12px;
    align-items: center;
    position: relative;
    z-index: 2;
    backdrop-filter: blur(5px);
  }
  .export-input {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 8px;
    font-size: 12px;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }
  .btn-copy {
    background: #333;
    color: white;
    border: 1px solid #555;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    transition: all 0.2s;
    font-family: 'Jua', sans-serif; /* Explicitly set Jua */
  }
  .btn-copy:hover { background: #555; border-color: #777; }

  /* Modal & Overlays */
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(8px);
  }
  
  /* Larger Modal Layout */
  .modal {
    background: linear-gradient(135deg, #2e1065, #0f0219);
    padding: 30px;
    border-radius: 24px;
    text-align: center;
    box-shadow: 0 0 50px rgba(217, 70, 239, 0.5);
    border: 2px solid var(--accent-color);
    min-width: 500px; /* Bigger Width */
    max-height: 85vh; /* Bigger Height */
    display: flex;
    flex-direction: column;
    transform: scale(0.9);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .modal.show {
    transform: scale(1);
    opacity: 1;
  }
  .modal h2 {
    color: var(--secondary-accent);
    font-size: 1.5rem;
    margin: 0 0 10px 0;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 0 0 10px rgba(34, 211, 238, 0.8);
  }
  .winner-text {
    font-size: 3.5rem;
    font-weight: 900;
    color: #ffff00;
    text-shadow: 0 0 20px rgba(255, 255, 0, 0.8), 0 0 40px rgba(255, 255, 0, 0.4);
    margin-bottom: 20px;
  }
  
  /* Stats List Inside Modal */
  .modal-stats-label {
    color: var(--text-muted);
    font-size: 14px;
    margin-top: 10px;
    margin-bottom: 8px;
    text-align: left;
    width: 100%;
    font-weight: 700;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding-bottom: 5px;
  }

  .modal-stats-list {
    flex: 1;
    overflow-y: auto;
    width: 100%;
    background: rgba(0,0,0,0.2);
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 10px;
    text-align: left;
  }
  /* Custom scrollbar for modal list */
  .modal-stats-list::-webkit-scrollbar { width: 6px; }
  .modal-stats-list::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }

  .stat-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 10px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    font-size: 15px;
    color: #e2e8f0;
  }
  .stat-row:last-child { border-bottom: none; }
  .stat-row.is-winner {
    background: rgba(255, 255, 0, 0.15);
    color: #ffff00;
    font-weight: bold;
    border-radius: 6px;
    border: 1px solid rgba(255, 255, 0, 0.3);
  }

  .modal-hint {
    color: var(--text-muted);
    margin-top: 10px;
    font-size: 0.9rem;
  }

  /* Toast */
  .toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: #4c1d95;
    color: #fff;
    padding: 12px 24px;
    border-radius: 30px;
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
    z-index: 2000;
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
    font-weight: 600;
    border: 1px solid var(--accent-color);
  }
  .toast.visible {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  @media (max-width: 900px) {
    .app-container { grid-template-columns: 1fr; height: auto; min-height: 100vh; overflow-y: auto; }
    .roulette-section { border-right: none; border-bottom: 1px solid var(--border-color); height: auto; padding-bottom: 40px; overflow: visible; }
    .controls-section { height: auto; overflow: visible; }
    .wheel-container { width: 300px; height: 300px; max-width: none; max-height: none; }
    .calc-container { margin-top: 20px; }
    .mascot-img { height: 40vh; }
  }
</style>
</head>
<body>

<div class="app-container">
  <!-- Left Side: Roulette & Calculator -->
  <section class="roulette-section">
    <div class="wheel-container">
      <div class="wheel-ring"></div>
      
      <!-- New Wrapper for Rotation -->
      <div class="wheel-rotator" id="wheelRotator">
        <div class="wheel" id="wheelCanvas"></div>
        <div class="wheel-labels" id="wheelLabels"></div>
      </div>

      <div class="wheel-center"></div>
      <!-- SVG Pointer -->
      <!-- ë¬¼ë°©ìš¸ ëª¨ì–‘ (ë™ê¸€ë™ê¸€í•œ í•€) -->
      <svg class="pointer" viewBox="0 0 40 50">
        <path d="M20 50 C20 50 40 30 40 18 C40 8 31 0 20 0 C9 0 0 8 0 18 C0 30 20 50 20 50 Z" 
              fill="#ffe0f7" stroke="#d946ef" stroke-width="2"/>
      </svg>
    </div>

    <div class="result-display">
      <div class="result-label">ë‹¹ì²¨ ê²°ê³¼</div>
      <div class="result-value" id="currentResult">-</div>
    </div>

    <!-- Toonation Stack Calculator -->
    <div class="calc-container">
      <div class="calc-header">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
        </svg>
        íˆ¬ë„¤ì´ì…˜ ìŠ¤íƒ ê³„ì‚°ê¸°
      </div>
      <div class="calc-input-group">
        <input type="number" id="calcInput" placeholder="0" inputmode="numeric" />
        <span>ì›</span>
      </div>
      <div class="calc-arrow">
        +20% (ìˆ˜ìˆ˜ë£Œ í¬í•¨)
      </div>
      <div class="calc-result-box">
        <div>
          <span class="calc-stack" id="calcStackResult">0</span>
          <span class="calc-stack-label">ìŠ¤íƒ</span>
        </div>
        <span class="calc-sub-text">
          ì¶©ì „ ê¸ˆì•¡: <span id="calcTotalMoney" class="calc-highlight">0</span>ì›
        </span>
      </div>
    </div>
  </section>

  <!-- Right Side: Controls -->
  <section class="controls-section">
    <!-- Mascot Image (Background Layer) -->
    <img id="mascot" class="mascot-img" src="https://github.com/heyrichoi/ingi/blob/main/2-removebg-preview.png?raw=true" alt="Mascot">

    <!-- Header: Spin Button & Timer -->
    <div class="controls-header">
      
      <div class="timer-container">
          <!-- Logo Moved Here (Inline Left) -->
          <img src="https://i.imgur.com/xRWsMAj.png" alt="Logo" class="header-logo-inline" />

          <!-- Quick Timer Buttons -->
          <div class="quick-timer-group">
            <button class="btn-quick" onclick="setTimer(60)">1ë¶„</button>
            <button class="btn-quick" onclick="setTimer(120)">2ë¶„</button>
            <button class="btn-quick" onclick="setTimer(180)">3ë¶„</button>
          </div>
  
          <div class="timer-box">
            <div class="timer-label">ìë™ íƒ€ì´ë¨¸</div>
            <div class="timer-display" id="timerDisplay">02:00</div>
            <input type="number" class="timer-edit-input" id="timerInput" value="120" />
          </div>
      </div>
      
      <button class="spin-btn" id="spinBtn">ëŒë ¤ëŒë ¤ ëŒë¦¼íŒ!</button>
    </div>

    <!-- Data Table -->
    <div class="data-table-container">
      <div class="table-header">
        <div>ì‚­ì œ</div>
        <div>ì´ë¦„</div>
        <div>ìŠ¤íƒ</div>
        <div>í™•ë¥ </div>
      </div>
      <div class="table-body" id="tableBody">
        <!-- Rows generated by JS -->
      </div>
      
      <!-- Fixed Add Button at bottom of list area -->
      <div class="add-row">
        <button class="btn-add" id="btnAddItem">
          <span>+</span> í•­ëª© ì¶”ê°€
        </button>
      </div>
    </div>

    <!-- Export Section (Hidden functionality for Donation Roulette) -->
    <div class="export-area">
      <div style="font-size:12px; color:var(--text-muted); white-space:nowrap;">ë‚´ë³´ë‚´ê¸°:</div>
      <input type="text" class="export-input" id="exportStr" readonly placeholder="ì´ë¦„*í¬ê¸°, ì´ë¦„*í¬ê¸°..." />
      <button class="btn-copy" id="btnCopy">ë³µì‚¬</button>
    </div>
  </section>
</div>

<!-- Winner Modal -->
<div class="overlay" id="modalOverlay">
  <div class="modal" id="winnerModal">
    <h2>ğŸ‰ ë‹¹ì²¨! ğŸ‰</h2>
    <div class="winner-text" id="winnerText">NAME</div>
    
    <!-- Stats Area -->
    <div class="modal-stats-label">ì „ì²´ í•­ëª© í˜„í™©</div>
    <div class="modal-stats-list" id="modalStatsList">
      <!-- JS Generated Content -->
    </div>

    <div class="modal-hint">í™”ë©´ì„ í´ë¦­í•˜ì—¬ ë‹«ê¸°</div>
  </div>
</div>

<div class="toast" id="toast">ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤</div>

<script>
/**
 * Application State
 */
const state = {
  // Renamed to í•­ëª© 1, í•­ëª© 2, í•­ëª© 3
  items: [
    { id: 1, name: 'í•­ëª© 1', weight: 1 },
    { id: 2, name: 'í•­ëª© 2', weight: 1 },
    { id: 3, name: 'í•­ëª© 3', weight: 1 },
  ],
  isSpinning: false, 
  spinPhase: 'idle', 
  rotation: 0,
  // Removed spinSpeed, animationId as they are no longer used for manual spin loop
  
  timerSeconds: 120, 
  defaultTimer: 120,
  timerInterval: null
};

// Neon Palette for Wheel Segments
const colors = [
  '#f43f5e', '#d946ef', '#8b5cf6', '#6366f1', '#3b82f6',
  '#0ea5e9', '#06b6d4', '#14b8a6', '#10b981', '#84cc16',
  '#eab308', '#f59e0b', '#f97316'
];

// URLs
const MASCOT_IDLE = 'https://github.com/heyrichoi/ingi/blob/main/2-removebg-preview.png?raw=true';
const MASCOT_ACTIVE = 'https://github.com/heyrichoi/ingi/blob/main/1-removebg-preview.png?raw=true';

// DOM Elements
const wheelCanvas = document.getElementById('wheelCanvas');
const wheelLabels = document.getElementById('wheelLabels');
const wheelRotator = document.getElementById('wheelRotator');
const tableBody = document.getElementById('tableBody');
const btnAddItem = document.getElementById('btnAddItem');
const spinBtn = document.getElementById('spinBtn');
const currentResult = document.getElementById('currentResult');
const exportStr = document.getElementById('exportStr');
const btnCopy = document.getElementById('btnCopy');
const timerDisplay = document.getElementById('timerDisplay');
const timerInput = document.getElementById('timerInput');
const modalOverlay = document.getElementById('modalOverlay');
const winnerModal = document.getElementById('winnerModal');
const winnerText = document.getElementById('winnerText');
const modalStatsList = document.getElementById('modalStatsList');
const toast = document.getElementById('toast');
const calcInput = document.getElementById('calcInput');
const calcStackResult = document.getElementById('calcStackResult');
const calcTotalMoney = document.getElementById('calcTotalMoney');
const mascotImg = document.getElementById('mascot');

/**
 * Calculator Logic
 */
calcInput.addEventListener('input', (e) => {
  const val = parseInt(e.target.value, 10);
  if (isNaN(val) || val < 0) {
    calcStackResult.textContent = '0';
    calcTotalMoney.textContent = '0';
    return;
  }
  const totalMoney = val * 1.2;
  let stacks = totalMoney / 1000;
  const formattedStacks = Number.isInteger(stacks) ? stacks : stacks.toFixed(1);

  calcStackResult.textContent = formattedStacks;
  calcTotalMoney.textContent = Math.floor(totalMoney).toLocaleString();
});

/**
 * Timer Logic
 */
function startTimer() {
  clearInterval(state.timerInterval);
  state.timerSeconds = state.defaultTimer;
  updateTimerDisplay();
  
  state.timerInterval = setInterval(() => {
    if (state.timerSeconds > 0) {
      state.timerSeconds--;
      updateTimerDisplay();
    } else {
      clearInterval(state.timerInterval);
      // Ensure urgent class removed when done or add specific done logic
    }
  }, 1000);
}

function updateTimerDisplay() {
  const m = Math.floor(state.timerSeconds / 60).toString().padStart(2, '0');
  const s = (state.timerSeconds % 60).toString().padStart(2, '0');
  timerDisplay.textContent = `${m}:${s}`;

  // Add urgent visual effects if <= 10 seconds and timer is running (seconds > 0)
  if (state.timerSeconds <= 10 && state.timerSeconds > 0) {
    timerDisplay.classList.add('urgent');
  } else {
    timerDisplay.classList.remove('urgent');
  }
}

// Quick Timer Function
function setTimer(seconds) {
  state.defaultTimer = seconds;
  state.timerSeconds = seconds;
  startTimer(); 
}
window.setTimer = setTimer;

timerDisplay.addEventListener('click', () => {
  timerInput.style.display = 'block';
  timerDisplay.style.display = 'none';
  timerInput.value = state.defaultTimer;
  timerInput.focus();
});

timerInput.addEventListener('blur', finishTimerEdit);
timerInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') finishTimerEdit();
});

function finishTimerEdit() {
  let val = parseInt(timerInput.value, 10);
  if (isNaN(val) || val < 1) val = 60;
  state.defaultTimer = val;
  state.timerSeconds = val;
  
  timerInput.style.display = 'none';
  timerDisplay.style.display = 'block';
  
  startTimer();
}

/**
 * Data Management
 */
function addItem() {
  if (state.isSpinning) return;
  const id = Date.now();
  const nextNum = state.items.length + 1;
  state.items.push({ id, name: `í•­ëª© ${nextNum}`, weight: 1 });
  renderTable();
  renderWheel();
  startTimer();
}

function deleteItem(id) {
  if (state.isSpinning) return;
  state.items = state.items.filter(item => item.id !== id);
  if (state.items.length === 0) {
    state.items.push({ id: Date.now(), name: 'í•­ëª© 1', weight: 1 });
  }
  renderTable();
  renderWheel();
  startTimer();
}

function updateItem(id, field, value) {
  if (state.isSpinning) return;
  const item = state.items.find(i => i.id === id);
  if (item) {
    if (field === 'weight') {
      let w = parseInt(value, 10);
      if (isNaN(w) || w < 0) w = 0;
      item.weight = w;
      renderTable(); // ë¬´ê²Œ ë³€ê²½ ì‹œì—ëŠ” í™•ë¥  ì¬ê³„ì‚°ì„ ìœ„í•´ í…Œì´ë¸” ê°±ì‹ 
    } else {
      item.name = value;
      updateExportStr(); // ì´ë¦„ ë³€ê²½ ì‹œì—ëŠ” í…Œì´ë¸” ê°±ì‹  ì—†ì´ ë°ì´í„°ë§Œ ì—…ë°ì´íŠ¸ (í¬ì»¤ìŠ¤ ìœ ì§€)
    }
    renderWheel();
    startTimer();
  }
}

function changeWeight(id, delta) {
  if (state.isSpinning) return;
  const item = state.items.find(i => i.id === id);
  if (item) {
    let newW = item.weight + delta;
    if (newW < 0) newW = 0;
    item.weight = newW;
    renderTable();
    renderWheel();
    startTimer();
  }
}

function getTotalWeight() {
  return state.items.reduce((sum, item) => sum + item.weight, 0);
}

// Export String Update Helper
function updateExportStr() {
  const validItems = state.items.filter(i => i.name.trim() !== '' && i.weight > 0);
  exportStr.value = validItems.map(i => `${i.name}*${i.weight}`).join(',');
}

/**
 * Rendering
 */
function renderTable() {
  tableBody.innerHTML = '';
  const total = getTotalWeight();

  updateExportStr(); // Use helper

  // Disable controls if spinning
  const disabledAttr = state.isSpinning ? 'disabled' : '';

  state.items.forEach(item => {
    const row = document.createElement('div');
    row.className = 'table-row';

    const percent = total > 0 ? ((item.weight / total) * 100).toFixed(1) : '0.0';

    row.innerHTML = `
      <div class="cell-action">
        <button class="btn-delete" onclick="deleteItem(${item.id})" ${disabledAttr}>âœ•</button>
      </div>
      <div class="cell-name">
        <input type="text" class="input-ghost" 
          value="${item.name}" 
          placeholder="ì´ë¦„ ì…ë ¥"
          oninput="updateItem(${item.id}, 'name', this.value)"
          ${disabledAttr}
        />
      </div>
      <div class="cell-weight">
        <button class="weight-btn" onclick="changeWeight(${item.id}, -1)" ${disabledAttr}>â—€</button>
        <input type="number" class="input-ghost input-number" 
          value="${item.weight}" 
          min="0"
          onchange="updateItem(${item.id}, 'weight', this.value)"
          ${disabledAttr}
        />
        <button class="weight-btn" onclick="changeWeight(${item.id}, 1)" ${disabledAttr}>â–¶</button>
      </div>
      <div class="prob-text">${percent}%</div>
    `;
    tableBody.appendChild(row);
  });

  // Also disable Add button
  btnAddItem.disabled = state.isSpinning;
}

function renderWheel() {
  const total = getTotalWeight();
  let accumulatedDeg = 0;
  
  wheelCanvas.innerHTML = '';
  wheelLabels.innerHTML = '';
  
  if (total === 0) {
    wheelCanvas.style.background = '#333';
    return;
  }

  let gradientStr = 'conic-gradient(';
  const assignedColors = [];
  
  state.items.forEach((item, index) => {
    let colorIndex = index % colors.length;
    let selectedColor = colors[colorIndex];

    if (index > 0) {
      if (selectedColor === assignedColors[index - 1]) {
        colorIndex = (colorIndex + 1) % colors.length;
        selectedColor = colors[colorIndex];
      }
    }
    
    if (index === state.items.length - 1 && state.items.length > 1) {
      const firstColor = assignedColors[0];
      while (selectedColor === assignedColors[index - 1] || selectedColor === firstColor) {
        colorIndex = (colorIndex + 1) % colors.length;
        selectedColor = colors[colorIndex];
      }
    }

    assignedColors.push(selectedColor);

    const deg = (item.weight / total) * 360;
    const startDeg = accumulatedDeg;
    const endDeg = accumulatedDeg + deg;
    
    gradientStr += `${selectedColor} ${startDeg}deg ${endDeg}deg,`;
    
    // Add Label
    if (deg > 5 && item.name) { 
      const labelDiv = document.createElement('div');
      labelDiv.className = 'slice-label';
      const midDeg = startDeg + (deg / 2);
      
      labelDiv.style.transform = `rotate(${midDeg - 90}deg)`;
      labelDiv.innerHTML = `<span>${item.name}</span>`;
      wheelLabels.appendChild(labelDiv);
    }
    
    accumulatedDeg += deg;
  });

  gradientStr = gradientStr.slice(0, -1) + ')';
  wheelCanvas.style.background = gradientStr;
}

/**
 * Mascot Logic
 */
function updateMascot() {
  if (state.isSpinning) {
    mascotImg.src = MASCOT_ACTIVE;
  } else {
    mascotImg.src = MASCOT_IDLE;
  }
}

/**
 * Spin Logic - REMOVED MANUAL LOOP
 */
// function spinLoop() { ... } - Deleted

spinBtn.addEventListener('click', () => {
  if (state.spinPhase === 'idle') {
    const total = getTotalWeight();
    if (total <= 0) {
      showToast("ë£°ë › í•­ëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš” (í¬ê¸° > 0)");
      return;
    }

    // Start Spinning (CSS Animation)
    state.spinPhase = 'spinning';
    state.isSpinning = true;
    updateMascot(); 
    renderTable(); // Disable controls

    spinBtn.textContent = "ë©ˆì¶”ê¸°!";
    spinBtn.classList.add('stop-mode');
    currentResult.textContent = '...';
    
    // Remove any previous transition and add spinning class
    wheelRotator.style.transition = 'none';
    wheelRotator.classList.add('spinning');
    
    // spinLoop(); - Removed call
  } else if (state.spinPhase === 'spinning') {
    // STOP BUTTON PRESSED
    state.spinPhase = 'stopping';
    // cancelAnimationFrame(state.animationId); - Removed

    // 1. Calculate current rotation from computed style before removing class
    const computedStyle = window.getComputedStyle(wheelRotator);
    const matrix = new WebKitCSSMatrix(computedStyle.transform);
    let currentRotation = Math.round(Math.atan2(matrix.b, matrix.a) * (180 / Math.PI));
    if (currentRotation < 0) currentRotation += 360;
    state.rotation = currentRotation; // Update state rotation to current

    // 2. Stop CSS Animation and freeze at current rotation
    wheelRotator.classList.remove('spinning');
    wheelRotator.style.transform = `rotate(${state.rotation}deg)`;

    spinBtn.disabled = true; 

    // Determine Winner
    const total = getTotalWeight();
    let random = Math.random() * total;
    let winner = null;
    let currentWeight = 0;
    let winnerIndex = 0;

    for (let i = 0; i < state.items.length; i++) {
      currentWeight += state.items[i].weight;
      if (random <= currentWeight) {
        winner = state.items[i];
        winnerIndex = i;
        break;
      }
    }

    // Calculate Target Angle
    let prevWeight = 0;
    for(let j=0; j<winnerIndex; j++) prevWeight += state.items[j].weight;
    
    const startAngle = (prevWeight / total) * 360;
    const sliceAngle = (winner.weight / total) * 360;
    const winnerCenterAngle = startAngle + (sliceAngle / 2);
    
    const currentRotMod = state.rotation % 360; 
    let targetRotMod = (360 - winnerCenterAngle); 
    
    let diff = targetRotMod - currentRotMod;
    if (diff < 0) diff += 360;
    
    // Extra spins for decelerating
    // ê´€ì„±ì„ ìœ„í•´ íšŒì „ìˆ˜ ì¦ê°€ (5 -> 15)
    const extraSpins = 360 * 15; 
    const finalRotation = state.rotation + diff + extraSpins;
    
    const fuzz = (Math.random() - 0.5) * (sliceAngle * 0.8);
    
    state.rotation = finalRotation + fuzz;

    // Force reflow to ensure the frozen transform is applied before starting transition
    void wheelRotator.offsetWidth;

    // Apply CSS Transition for smooth stop (Deceleration curve)
    // Using an ease-out curve for deceleration
    // ì‹œê°„ë„ ì‚´ì§ ëŠ˜ë¦¼ (6s -> 7s)
    wheelRotator.style.transition = 'transform 7s cubic-bezier(0.1, 1, 0.1, 1)';
    wheelRotator.style.transform = `rotate(${state.rotation}deg)`;

    setTimeout(() => {
      state.isSpinning = false;
      state.spinPhase = 'idle';
      updateMascot(); 
      renderTable(); // Enable controls

      spinBtn.disabled = false;
      spinBtn.textContent = "ëŒë ¤ëŒë ¤ ëŒë¦¼íŒ!";
      spinBtn.classList.remove('stop-mode');
      
      // Calculate Stats
      const probability = ((winner.weight / total) * 100).toFixed(1);
      
      // Update Result with details
      currentResult.innerHTML = `
        ${winner.name}
        <div class="result-detail">
          ${winner.weight}ìŠ¤íƒ / ${probability}%
        </div>
      `;
      winnerText.textContent = winner.name;
      
      // Populate Modal Stats List
      modalStatsList.innerHTML = '';
      state.items.forEach(item => {
        const p = ((item.weight / total) * 100).toFixed(1);
        const isWinner = item.id === winner.id;
        
        const row = document.createElement('div');
        row.className = `stat-row ${isWinner ? 'is-winner' : ''}`;
        row.innerHTML = `
          <span>${item.name}</span>
          <span>${item.weight}ìŠ¤íƒ (${p}%)</span>
        `;
        modalStatsList.appendChild(row);
      });

      modalOverlay.style.display = 'flex';
      void winnerModal.offsetWidth;
      winnerModal.classList.add('show');
    }, 7100); // Slightly longer than transition
  }
});

// Modal Close
modalOverlay.addEventListener('click', () => {
  winnerModal.classList.remove('show');
  setTimeout(() => {
    modalOverlay.style.display = 'none';
  }, 300);
});

btnCopy.addEventListener('click', () => {
  exportStr.select();
  document.execCommand('copy');
  showToast('í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
});

function showToast(msg) {
  toast.textContent = msg;
  toast.classList.add('visible');
  setTimeout(() => toast.classList.remove('visible'), 2000);
}

// Global exposure
window.deleteItem = deleteItem;
window.updateItem = updateItem;
window.changeWeight = changeWeight;

// Init
btnAddItem.addEventListener('click', addItem);
renderTable();
renderWheel();
startTimer();
updateMascot(); 

</script>
</body>
</html>
